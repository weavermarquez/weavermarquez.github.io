<!-- Generated from 310d701 on 2023-12-19 @ 09:37 with Emacs 27.2 (Org mode 9.4.4) -->
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta author="System Crafters - David Wilson"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="icon" type="image/png" href="/img/favicon.png"/><link rel="alternative" type="application/rss+xml" title="System Crafters News" href="https://weavermarquez.github.io/rss/news.xml"/><link rel="stylesheet" href="https://weavermarquez.github.io/fonts/iosevka-aile/iosevka-aile.css"/><link rel="stylesheet" href="https://weavermarquez.github.io/fonts/jetbrains-mono/jetbrains-mono.css"/><link rel="stylesheet" href="https://weavermarquez.github.io/css/code.css"/><link rel="stylesheet" href="https://weavermarquez.github.io/css/site.css"/><script defer="defer" data-domain="weavermarquez.github.io" src="https://plausible.io/js/plausible.js"></script><title>Modular Emacs Configuration Strategies - System Crafters</title></head><body><header class="site-header"><div class="container"><div class="site-title"><img class="logo" src="https://weavermarquez.github.io/img/sc_logo.png" alt="System Crafters"/></div></div><div class="site-masthead"><div class="container"><nav class="nav"><a class="nav-link" href="/">Home</a> <a class="nav-link" href="/guides/">Guides</a> <a class="nav-link" href="/news/">News</a> <a class="nav-link" href="/community/">Community</a> <a class="nav-link" href="/">Home (2)</a> <a class="nav-link" href="/how-to-help/">How to Help</a></nav></div></div></header><div class="container"><div class="site-post"><h1 class="site-post-title">Modular Emacs Configuration Strategies</h1><p class="site-post-meta">June 10, 2022</p><div class="video">  <iframe src="https://www.youtube.com/embed/y7E18HpG1wU" allowfullscreen></iframe></div><div id="content">
<h2><a id="updates" class="anchor" href="#updates">¶</a>Updates</h2><div class="outline-text-2" id="text-orge714500">
<ul class="org-ul">
<li>Video on Modus Themes coming out tomorrow!</li>
</ul>
</div>

<h2><a id="modular-emacs-configuration-strategies" class="anchor" href="#modular-emacs-configuration-strategies">¶</a>Modular Emacs Configuration Strategies</h2><div class="outline-text-2" id="text-orgc7ccb7e">
<p>
Today I want to discuss how to create an Emacs configuration that can satisfy a few goals:
</p>
</div>

<h3><a id="works-well-across-multiple-platforms-linux-windows-macos-even-mobile-via-termux" class="anchor" href="#works-well-across-multiple-platforms-linux-windows-macos-even-mobile-via-termux">¶</a>Works well across multiple platforms (Linux, Windows, macOS, even mobile via Termux)</h3><div class="outline-text-3" id="text-org294d93c">
<ul class="org-ul">
<li>Use <code>system-type</code> variable to choose which configuration parts to load</li>
<li><i>Maybe</i> use <code>system-name</code> to do machine-specific configurations when multiple machines use the same OS</li>
<li>Standard file paths for certain things, avoiding shelling out to certain programs</li>
<li>Use eshell for all shell activity</li>
</ul>
</div>

<h3><a id="can-be-configured-with-guix" class="anchor" href="#can-be-configured-with-guix">¶</a>Can be configured with Guix</h3><div class="outline-text-3" id="text-org5d459e6">
<ul class="org-ul">
<li>All configuration modules are written in a slightly platform-agnostic way (maybe some special-casing)</li>
<li>Configuration points of these modules are exposed via <code>defcustom</code> and <code>defvar</code></li>
<li>When configuring Emacs via Guix, the Guix Home configuration services will expose their own variables so that you can configure certain things at the Scheme level, then the corresponding Emacs Lisp will get generated and loaded as part of Emacs startup</li>
<li>The benefit of this is that you can do machine-specific configuration
<ul class="org-ul">
<li>Certain modules can be loaded, their dependencies will only be installed on that machine</li>
</ul></li>
</ul>

<p>
Even if you don&rsquo;t use Guix, you could probably use standard dotfiles management tools like Chezmoi or yadm to accomplish something similar.
</p>

<p>
Case&rsquo;s module: <a href="https://github.com/duckwork/machine.el">https://github.com/duckwork/machine.el</a>
</p>
</div>

<h3><a id="enables-standalone-emacs-sessions" class="anchor" href="#enables-standalone-emacs-sessions">¶</a>Enables standalone Emacs sessions</h3><div class="outline-text-3" id="text-org1d8ee78">
<ul class="org-ul">
<li>Working on multiple projects at the same time, managing all the buffers and windows in Emacs can be challenging</li>
<li>Obviously there are lots of packages for dealing with this, but it&rsquo;s still not perfect</li>
<li>What if you can just launch a special-purpose Emacs session that isn&rsquo;t connected to your main session to load only the packages needed and keep your buffer list clean</li>
</ul>

<p>
Why?
</p>

<ul class="org-ul">
<li>If Emacs gets in a bad state, just kill it</li>
<li>Not needing to load a bunch of unnecessary tools or packages (things like <code>use-package</code> or <code>with-eval-after-load</code> make this less of a problem)</li>
<li>When you&rsquo;re finished working on a particular task, close everything related to it</li>
<li>Some blocking operations (like network traffic from IRC, mail, etc) can make it harder to use Emacs smoothly while working on something unrelated</li>
</ul>

<p>
<a href="http://wiki.systemcrafters.net/guix/nvidia/">http://wiki.systemcrafters.net/guix/nvidia/</a>
</p>
</div>

<h3><a id="things-to-look-at" class="anchor" href="#things-to-look-at">¶</a>Things to look at</h3><div class="outline-text-3" id="text-orgcbb13fc">
<ul class="org-ul">
<li>New Emacs command line option for different config directories</li>
</ul>
</div>

<h2><a id="modular-configuration-style" class="anchor" href="#modular-configuration-style">¶</a>Modular configuration style</h2><div class="outline-text-2" id="text-orgd27830a">
<ul class="org-ul">
<li>Like Rational Emacs, split various parts of functionality into separate Emacs Lisp modules that are part of your own configuration</li>
<li>The ideal model is to have an <code>init.el</code> file that purely just loads in the necessary modules for a given machine, plus any additional modules that are context-specific</li>
<li>The base configuration would only load the necessary things for everyday use</li>
<li>However, you might have environment variables or command line flags to enable a specific &ldquo;profile&rdquo; (sounds like Chemacs2, right?) (use <code>command-switch-alist</code>)</li>
<li>You could also use <code>.dir-locals.el</code> to load a specific module when entering the directory</li>
</ul>
</div>

<h2><a id="speculative-macro-syntax" class="anchor" href="#speculative-macro-syntax">¶</a>Speculative macro syntax</h2><div class="outline-text-2" id="text-orgabfdd59">
<p>
Something we might try to implement someday:
</p>

<pre>(with-system
 (all
  (set-theme modus-vivendi)
  (load-modules rational-ui
                rational-evil))
 ((<span class="org-keyword">and</span> linux <span class="org-string">"phantom"</span>)
  (set-theme doom-palenight)
  (load-modules rational-desktop))
 (windows
  (load-modules rational-powershell)))</pre>
</div>
</div></div><div class="list-form center"><div class="list-form-title">Subscribe to the System Crafters Newsletter!</div><form method="POST" action="https://www.simplelists.com/subscribe.php"><input type="hidden" name="format" value="text"/><input type="hidden" name="action" value="subscribe"/><input type="hidden" name="list" value="news@lists.systemcrafters.net"/><div class="list-form-message">Stay up to date with the latest System Crafters news and updates!  Read the <a href="/newsletter/">Newsletter</a> page for more information.</div><div class="row"><div class="column"><div class="row center list-form-label">Name (optional)</div><div class="row"><input type="text" name="name"/></div></div><div class="column"><div class="row center list-form-label">Email Address</div><div class="row"><input type="text" name="email"/></div></div></div><div><input type="submit" value="Subscribe!"/></div></form></div></div><footer class="site-footer"><div class="container"><div class="row"><div class="column"><p><a href="https://weavermarquez.github.io/privacy-policy/">Privacy Policy</a> · <a href="https://weavermarquez.github.io/credits/">Credits</a> · <a href="https://weavermarquez.github.io/rss/">RSS Feeds</a> · <a rel="me" href="https://fosstodon.org/@daviwil">Fediverse</a></p><p>© 2021-2023 System Crafters LLC, and also Weaver Ripped this off</p></div><div class="column align-right"><p><a href="https://github.com/weavermarquez/weavermarquez.github.io"><img src="https://weavermarquez.github.io/img/codeberg.png" style="width: 120px" alt="Contribute on Codeberg"/></a></p></div></div></div></footer></body></html>
