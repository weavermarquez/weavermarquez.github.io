<!-- Generated from dbca41c on 2023-12-28 @ 00:36 with Emacs 27.2 (Org mode 9.4.4) -->
<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta author="System Crafters - David Wilson"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><link rel="icon" type="image/png" href="/img/favicon.png"/><link rel="alternative" type="application/rss+xml" title="System Crafters News" href="https://weavermarquez.github.io/rss/news.xml"/><link rel="stylesheet" href="https://weavermarquez.github.io/fonts/iosevka-aile/iosevka-aile.css"/><link rel="stylesheet" href="https://weavermarquez.github.io/fonts/jetbrains-mono/jetbrains-mono.css"/><link rel="stylesheet" href="https://weavermarquez.github.io/css/code.css"/><link rel="stylesheet" href="https://weavermarquez.github.io/css/site.css"/><script defer="defer" data-domain="weavermarquez.github.io" src="https://plausible.io/js/plausible.js"></script><title>Configuring HerbstluftWM with Emacs Lisp - System Crafters</title></head><body><header class="site-header"><div class="container"><div class="site-title"><img class="logo" src="https://weavermarquez.github.io/img/sc_logo.png" alt="System Crafters"/></div></div><div class="site-masthead"><div class="container"><nav class="nav"><a class="nav-link" href="/">Home</a> <a class="nav-link" href="/guides/">Guides</a> <a class="nav-link" href="/news/">News</a> <a class="nav-link" href="/community/">Community</a> <a class="nav-link" href="/">Home (2)</a> <a class="nav-link" href="/how-to-help/">How to Help</a></nav></div></div></header><div class="container"><div class="site-post"><h1 class="site-post-title">Configuring HerbstluftWM with Emacs Lisp</h1><p class="site-post-meta">June 24, 2022</p><div class="video">  <iframe src="https://www.youtube.com/embed/OMcpd9ixPOU" allowfullscreen></iframe></div><div id="content">
<h2><a id="updates" class="anchor" href="#updates">¶</a>Updates</h2><div class="outline-text-2" id="text-orgd2cabae">
<ul class="org-ul">
<li>I&rsquo;ve replaced EXWM with HerbstluftWM in my configuration and I like it!</li>
<li>Next video will be about how I show &ldquo;presentation&rdquo; slides in Org Mode like in my videos</li>
</ul>
</div>

<h2><a id="configuring-herbstluftwm-with-emacs-lisp" class="anchor" href="#configuring-herbstluftwm-with-emacs-lisp">¶</a>Configuring HerbstluftWM with Emacs Lisp</h2><div class="outline-text-2" id="text-org041c08f">
<p>
Today we&rsquo;re going to try and write an Emacs Lisp package that can control the venerable <a href="https://herbstluftwm.org/">Herbstluft Window Manager</a>.
</p>

<p>
This is a really fun and versatile tiling window manager which (like <code>bspwm</code>) is configured through a command line interface called <code>herbstclient</code>.
</p>

<p>
An interesting implication of how you configure <code>herbstluftwm</code> is that the configuration file can be written as a script in any language you like so long as it&rsquo;s at the expected configuration path (<code>~/.config/herbstluftwm/autostart</code>) and properly executable.
</p>

<p>
Let&rsquo;s build the configuration package and try to write a simple configuration script in Emacs Lisp!
</p>

<p>
Here are a few of the things we&rsquo;ll try to script:
</p>
</div>

<h3><a id="changing-settings-variables" class="anchor" href="#changing-settings-variables">¶</a>Changing settings variables</h3>

<h3><a id="setting-the-theme" class="anchor" href="#setting-the-theme">¶</a>Setting the theme</h3>

<h3><a id="configuring-key-bindings" class="anchor" href="#configuring-key-bindings">¶</a>Configuring key bindings</h3>

<h3><a id="workspace-management" class="anchor" href="#workspace-management">¶</a>Workspace management</h3>

<h3><a id="window-management" class="anchor" href="#window-management">¶</a>Window management</h3>

<h2><a id="the-final-code" class="anchor" href="#the-final-code">¶</a>The final code</h2><div class="outline-text-2" id="text-org1a73217">
<pre>(<span class="org-keyword">require</span> '<span class="org-constant">cl-lib</span>)

(<span class="org-keyword">defun</span> <span class="org-function-name">herbst-run-command</span> (command)
  (start-process-shell-command <span class="org-string">"herbstclient"</span>
                               nil
                               (format <span class="org-string">"herbstclient %s"</span> command)))

(<span class="org-keyword">defun</span> <span class="org-function-name">herbst-run-commands</span> (<span class="org-type">&amp;rest</span> commands)
  (mapcar #'herbst-run-command commands))

(<span class="org-keyword">defun</span> <span class="org-function-name">herbst-set</span> (setting-name value)
  (herbst-run-command (format  <span class="org-string">"set %s %s"</span> setting-name value)))

(herbst-set <span class="org-string">"frame_gap"</span> 10)

(<span class="org-keyword">defmacro</span> <span class="org-function-name">herbst-setq</span> (<span class="org-type">&amp;rest</span> setting-pairs)
  `(<span class="org-keyword">progn</span>
     ,@(<span class="org-keyword">cl-loop</span> for (key val) on setting-pairs by #'cddr collect
                `(herbst-run-command ,(format <span class="org-string">"set %s %s"</span>
                                              (string-replace <span class="org-string">"-"</span> <span class="org-string">"_"</span> (symbol-name key))
                                              val)))))

(<span class="org-keyword">defmacro</span> <span class="org-function-name">herbst-set-attr</span> (<span class="org-type">&amp;rest</span> attr-lists)
  `(herbst-run-commands ,@(herbst--attr-list-to-strings <span class="org-string">""</span> attr-lists)))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Building up the object path</span>

(<span class="org-keyword">defun</span> <span class="org-function-name">herbst--attr-list-to-strings</span> (current-path current-item)
  (<span class="org-keyword">if</span> current-item
      (<span class="org-keyword">if</span> (listp (car current-item))
          <span class="org-comment-delimiter">;; </span><span class="org-comment">This needs to loop</span>
          (apply #'append
                 (mapcar (<span class="org-keyword">lambda</span> (item)
                           (herbst--attr-list-to-strings current-path item))
                         current-item))
        (<span class="org-keyword">if</span> (keywordp (car current-item))
            (append
             (list (format <span class="org-string">"attr %s%s %s"</span>
                           current-path
                           (string-replace <span class="org-string">"-"</span>
                                           <span class="org-string">"_"</span>
                                           (substring (symbol-name (car current-item)) 1))
                           (cadr current-item)))
             (herbst--attr-list-to-strings current-path (cddr current-item)))
          (<span class="org-keyword">if</span> (symbolp (car current-item))
              (herbst--attr-list-to-strings
               (concat current-path
                       (symbol-name (car current-item))
                       <span class="org-string">"."</span>)
               (cdr current-item)))))
    '()))

<span class="org-comment-delimiter">;; </span><span class="org-comment">Speculative key binding syntax</span>
<span class="org-comment-delimiter">;; </span><span class="org-comment">(herbst-define-key "S-c" "cycle"</span>
<span class="org-comment-delimiter">;;                    </span><span class="org-comment">"S-i" "jumpto urgent"</span>
<span class="org-comment-delimiter">;;                    </span><span class="org-comment">"S-q" "close_and_remove")</span>

(<span class="org-keyword">provide</span> '<span class="org-constant">herbstmacs</span>)</pre>

<p>
The <code>autostart</code> file:
</p>

<pre>#!/usr/bin/env -S emacs -Q --script

<span class="org-comment-delimiter">;; </span><span class="org-comment">TODO: Don't harcode this path!</span>
(load <span class="org-string">"~/Projects/Code/herbstmacs/herbstmacs.el"</span>)

(herbst-setq frame-gap 10
             window-gap 0
             smart-frame-surroundings off)

(herbst-set-attr
 (theme <span class="org-builtin">:title-font</span> <span class="org-string">"'JetBrains Mono:pixelsize=32'"</span>
        <span class="org-builtin">:title-height</span> 40
        <span class="org-builtin">:title-depth</span> 15
        <span class="org-builtin">:outer-width</span> 3
        (floating <span class="org-builtin">:border-width</span> 4
                  <span class="org-builtin">:outer-width</span> 1
                  <span class="org-builtin">:outer-color</span> black)
        (urgent <span class="org-builtin">:inner-color</span> <span class="org-string">"#9A65B0"</span>)))</pre>
</div>
</div></div><div class="list-form center"><div class="list-form-title">Subscribe to the System Crafters Newsletter!</div><form method="POST" action="https://www.simplelists.com/subscribe.php"><input type="hidden" name="format" value="text"/><input type="hidden" name="action" value="subscribe"/><input type="hidden" name="list" value="news@lists.systemcrafters.net"/><div class="list-form-message">Stay up to date with the latest System Crafters news and updates!  Read the <a href="/newsletter/">Newsletter</a> page for more information.</div><div class="row"><div class="column"><div class="row center list-form-label">Name (optional)</div><div class="row"><input type="text" name="name"/></div></div><div class="column"><div class="row center list-form-label">Email Address</div><div class="row"><input type="text" name="email"/></div></div></div><div><input type="submit" value="Subscribe!"/></div></form></div></div><footer class="site-footer"><div class="container"><div class="row"><div class="column"><p><a href="https://weavermarquez.github.io/privacy-policy/">Privacy Policy</a> · <a href="https://weavermarquez.github.io/credits/">Credits</a> · <a href="https://weavermarquez.github.io/rss/">RSS Feeds</a> · <a rel="me" href="https://fosstodon.org/@daviwil">Fediverse</a></p><p>© 2021-2023 System Crafters LLC, and also Weaver Ripped this off</p></div><div class="column align-right"><p><a href="https://github.com/weavermarquez/weavermarquez.github.io"><img src="https://weavermarquez.github.io/img/codeberg.png" style="width: 120px" alt="Contribute on Codeberg"/></a></p></div></div></div></footer></body></html>
